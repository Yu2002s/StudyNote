<html>
  <head>
	  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>i5ting_ztree_toc:</title>
		<link href="toc/style/github-bf51422f4bb36427d391e4b75a1daa083c2d840e.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/style/github2-d731afd4f624c99a4b19ad69f3083cd6d02b81d5.css" media="all" rel="stylesheet" type="text/css"/>
		<link href="toc/css/zTreeStyle/zTreeStyle.css" media="all" rel="stylesheet" type="text/css"/>
	  <style>
		pre {
		    counter-reset: line-numbering;
		    border: solid 1px #d9d9d9;
		    border-radius: 0;
		    background: #fff;
		    padding: 0;
		    line-height: 23px;
		    margin-bottom: 30px;
		    white-space: pre;
		    overflow-x: auto;
		    word-break: inherit;
		    word-wrap: inherit;
		}

		pre a::before {
		  content: counter(line-numbering);
		  counter-increment: line-numbering;
		  padding-right: 1em; /* space after numbers */
		  width: 25px;
		  text-align: right;
		  opacity: 0.7;
		  display: inline-block;
		  color: #aaa;
		  background: #eee;
		  margin-right: 16px;
		  padding: 2px 10px;
		  font-size: 13px;
		  -webkit-touch-callout: none;
		  -webkit-user-select: none;
		  -khtml-user-select: none;
		  -moz-user-select: none;
		  -ms-user-select: none;
		  user-select: none;
		}

		pre a:first-of-type::before {
		  padding-top: 10px;
		}

		pre a:last-of-type::before {
		  padding-bottom: 10px;
		}

		pre a:only-of-type::before {
		  padding: 10px;
		}

		.highlight { background-color: #ffffcc } /* RIGHT */
		</style>
  </head>
  <body>
	  <div>
				<div style='width:25%;'>
						<ul id="tree" class="ztree" style='width:100%'>

						</ul>
				</div>
        <div id='readme' style='width:70%;margin-left:20%;'>
          	<article class='markdown-body'>
            	<h3 id="-">构建项目</h3>
<p>vite</p>
<pre><code class="lang-bash">npm init vite@latest
</code></pre>
<p>vue</p>
<pre><code class="lang-bash">npm init vue@latest
</code></pre>
<p>npx</p>
<pre><code class="lang-bash">npx create-vue demo
</code></pre>
<h3 id="-">响应式</h3>
<pre><code class="lang-ts">const a = ref({name: &#39;123&#39;})
const b = shallowRef({name: &#39;321&#39;})
// ref 深层次响应式
// shallowRef浅层次ref
// 修改shallowRef的值，需要直接修改value的值，修改vue中值的属性将无法更新视图层
// ref与shallowRef一起写将影响shallowRef的视图更新
// triggerRef 强制更新视图层

// customRef 自定义Ref
function MyRef&lt;T&gt; (value: T) {
    return customRef((track, trigger) =&gt; {
        return {
            get() {
                track()
                return value
            },
            set (newValue) {
                value = newValue
                trigger()
            }
        }
    })
}
</code></pre>
<p>toRef: 只能修改响应式对象的值，非响应式视图毫无变化</p>
<pre><code class="lang-ts">const like = toRef(man, &#39;like&#39;)
like.value = &#39;xxx&#39;
</code></pre>
<p>toRefs: 响应式对象中属性支持响应式</p>
<pre><code class="lang-ts">const toRefs = &lt;T extends object&gt;(object: T) =&gt; {
    const map: any = {}
    for (let key in object) {
        map[key] = toRef(object, key)
    }
    return map
}

const {name, age, like} = toRefs(man)
</code></pre>
<p>toRaw: 把响应式对象包装成普通对象</p>
<p>reactive实现</p>
<pre><code class="lang-ts">const isObject = (target) =&gt; target != null &amp;&amp; typeof target === &#39;object&#39;

export const reactive = &lt;T extends object&gt; (target: T) =&gt; {
    return new Proxy(target, {
        get (target, key, receiver) {
            track()
            const res = Reflect.get(target, key, receiver) as object
            if (isObject(res)) {
                return reactive(res)
            }
            return res
        },
        set (target, key, value, receiver) {
            trigger(target, key)
            return Reflect.set(target, key, value, receiver)
        }
    })
}
</code></pre>
<p>effect</p>
<pre><code class="lang-ts">let activeEffect

export const effect = (fn: Function) =&gt; {
    const _effect = function() {
        activeEffect = _effect
        let res = fn()
        return res
    }

    _effect()
    return _effect
}

const targetMap = new WeekMap()

export const track = (target, key) =&gt; {
    let depsMap = targetMap[target]
    if (!depsMap) {
        depsMap = new Map()
        targetMap.set(target, depsMap)
    }
    let deps = depsMap.get(key)
    if (!deps) {
        deps = new Set()
        depsMap.set(key, deps)
    }

    deps.add(activeEffect)
}

export const trigger = (target, key) =&gt; {
    const depsMap = targetMap.get(target)
    const deps = depsMap.get(key)

    deps.forEach(effect =&gt; {
        effect()
    })
}
</code></pre>
<h3 id="-">计算属性</h3>
<pre><code class="lang-vue">&lt;template&gt;
    &lt;div&gt;
        &lt;input type=&#39;text&#39; v-model=&#39;firstName&#39;/&gt;
        &lt;input type=&#39;text&#39; v-model=&#39;lastName&#39;/&gt;
    &lt;/div&gt;
    &lt;div&gt;
        fullName: {{ name }}
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
    const firstName = ref&lt;string&gt;(&#39;张&#39;)
    const lastName = ref&lt;string&gt;(&#39;三&#39;)

    // 选项式写法
    const name = computed({
        get() {
            return firstName.value + lastName.value
        },
        set (newVal) {
            [firstName.value, lastName.value] = newVal.split(&#39;-&#39;)
        }
    })

    // 函数式写法（只支持getter）
    const name = computed(() =&gt; {
        return firstName.value + lastName.value
    })
&lt;/script&gt;
</code></pre>
<h4 id="-">实战用法</h4>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import {computed, ref} from &quot;vue&quot;;

interface Data {
  id: number,
  name: string,
  price: number,
  num: number
}

const goods = ref&lt;Data&gt;({
  id: 0,
  name: &#39;&#39;,
  price: 0,
  num: 0
})

const goodsName = ref&lt;string&gt;(&#39;&#39;)

const data = ref&lt;Data[]&gt;([
  {
    id: 0,
    name: &#39;东宇的帽子&#39;,
    price: 666,
    num: 1
  },
  {
    id: 1,
    name: &#39;东宇的鞋子&#39;,
    price: 199,
    num: 2
  },
  {
    id: 2,
    name: &#39;东宇的衣服&#39;,
    price: 88,
    num: 4
  }
])

const deleteGoods = (index: number) =&gt; {
  data.value.splice(index, 1)
}

const editGoods = (index: number) =&gt; {
  const currentGoods = data.value[index]
  currentGoods.num = 1
}

const addNum = (goods: Data) =&gt; {
  goods.num++
}

const reduceNum = (goods: Data) =&gt; {
  if (goods.num &lt;= 0) return
  goods.num--
}

const total = computed&lt;number&gt;((): number =&gt; {
  return data.value.reduce((prev: number, next: Data) =&gt; {
    return prev + next.num
  }, 0)
})

const totalPrice = computed&lt;number&gt;((): number =&gt; {
  return data.value.reduce((prev: number, next: Data) =&gt; {
    return prev + next.price * next.num
  }, 0)
})

const addGoods = () =&gt; {
  goods.value.id = data.value.length == 0 ? 1 : data.value[data.value.length - 1].id + 1
  const goodsItem = goods.value
  data.value.unshift({
    id: goodsItem.id,
    name: goodsItem.name,
    price: goodsItem.price,
    num: goodsItem.num
  })
  goodsItem.id = 0
  goodsItem.name = &#39;&#39;
  goodsItem.price = 0
  goodsItem.num = 0
}

const searchGoods = () =&gt; {
  data.value = data.value.filter((item) =&gt; {
    return item.name.includes(goodsName.value)
  })
  goodsName.value = &#39;&#39;
}

const resetSearch = () =&gt; {
  goodsName.value = &#39;&#39;
}

&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;h3&gt;搜索商品&lt;/h3&gt;
    &lt;input v-model=&quot;goodsName&quot; type=&quot;text&quot; placeholder=&quot;搜索关键字&quot;&gt;
    &lt;button @click=&quot;searchGoods&quot;&gt;搜索&lt;/button&gt;
    &lt;button @click=&quot;resetSearch&quot;&gt;重置&lt;/button&gt;
  &lt;/div&gt;
  &lt;hr&gt;
  &lt;div&gt;
    &lt;h3&gt;添加商品&lt;/h3&gt;
    &lt;form @submit.prevent=&quot;addGoods&quot;&gt;
      &lt;label&gt;
        名称：
        &lt;input v-model=&quot;goods.name&quot; type=&quot;text&quot; placeholder=&quot;商品名称&quot;&gt;
      &lt;/label&gt;
      &lt;label&gt;
        价格：
        &lt;input v-model=&quot;goods.price&quot; type=&quot;number&quot; placeholder=&quot;商品价格&quot;&gt;
      &lt;/label&gt;
      &lt;label&gt;
        数量：
        &lt;input v-model=&quot;goods.num&quot; type=&quot;number&quot; placeholder=&quot;商品数量&quot;&gt;
      &lt;/label&gt;
      &lt;div style=&quot;margin-top: 20px;&quot;&gt;
        &lt;button type=&quot;submit&quot;&gt;添加商品&lt;/button&gt;
      &lt;/div&gt;
    &lt;/form&gt;
  &lt;/div&gt;
  &lt;table border cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;margin-top: 20px;&quot;&gt;
    &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;物品ID&lt;/th&gt;
      &lt;th&gt;物品名称&lt;/th&gt;
      &lt;th&gt;物品单价&lt;/th&gt;
      &lt;th&gt;物品数量&lt;/th&gt;
      &lt;th&gt;物品总价&lt;/th&gt;
      &lt;th&gt;操作&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;
      &lt;td&gt;{{ item.id }}&lt;/td&gt;
      &lt;td&gt; {{ item.name }}&lt;/td&gt;
      &lt;td&gt;{{ item.price }}&lt;/td&gt;
      &lt;td&gt;
        &lt;button @click=&quot;reduceNum(item)&quot;&gt;-&lt;/button&gt;
        {{ item.num }}
        &lt;button @click=&quot;addNum(item)&quot;&gt;+&lt;/button&gt;
      &lt;/td&gt;
      &lt;td&gt;{{ item.price * item.num }}&lt;/td&gt;
      &lt;td&gt;
        &lt;button @click=&quot;deleteGoods(index)&quot;&gt;删除&lt;/button&gt;
        &lt;button @click=&quot;editGoods(index)&quot;&gt;修改&lt;/button&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
    &lt;tfoot&gt;
    &lt;tr&gt;
      &lt;td colspan=&quot;3&quot;&gt;总价: {{ totalPrice }}&lt;/td&gt;
      &lt;td colspan=&quot;3&quot;&gt;总数量: {{ total }}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tfoot&gt;
  &lt;/table&gt;
&lt;/template&gt;

&lt;style scoped&gt;
td, th {
  padding: 10px;
}
&lt;/style&gt;
</code></pre>
<p>计算属性源码</p>
<pre><code class="lang-ts">import {effect} from &#39;./effect&#39;

export const computed = (getter: Function) =&gt; {
    let _value = effect(getter)
    let cateValue
    let _dirty = true

    class ComputedRefImpl {
       get value () {
           if (_dirty) {
               catchValue = _value()
               _dirty = false
           }
           return catchValue
       }
    }
    return new ComputedRefImpl()
}
</code></pre>
<h3 id="-">侦听器</h3>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;

import {ref, watchEffect} from &quot;vue&quot;;

const message = ref&lt;string&gt;(&#39;飞机&#39;)
const message2 = ref&lt;string&gt;(&#39;飞机杯子&#39;)

const unWatch = watchEffect((onCleanup) =&gt; {
  console.log(&#39;message: &#39;, message.value)
  console.log(&#39;message2: &#39;, message2.value)
  onCleanup(() =&gt; {
    console.log(&#39;before&#39;)
  })
}, {
  flush: &quot;pre&quot;,
  onTrigger (e) {
    debugger
  }
})

unWatch()

&lt;/script&gt;
</code></pre>
<p>其他实现</p>
<pre><code class="lang-ts">// 侦听user对象
watch(user, (newUser, oldUser) =&gt; {
  // console.log(newUser, oldUser)
})

// 监听对象可以是一个getter函数，当函数内的属性发生改变时，则会触发回调
// 请勿直接侦听响应式的对象的属性值，请使用 getter函数返回需要侦听的属性
watch(() =&gt; user.age * 2, (sum) =&gt; {
  // console.log(sum)
})

// 侦听多个属性
watch([user, () =&gt; user.age], ([newValue1, newValue2]) =&gt; {
  // console.log(newValue1, newValue2)
})

// 定义一个响应式对象
const obj = reactive({ count: 0 })
// 不能直接侦听响应式对象的属性值
/*watch(obj.count, (newValue) =&gt; {

})*/
// 使用构造函数侦听响应式对象的属性
watch((): number =&gt; obj.count, (newVal: number) =&gt; {
  // console.log(newVal)
})

// 深层侦听器
watch(obj, (newValue, oldValue) =&gt; {
  // 在对象的属性值发生更改时调用
  // console.log(newValue, oldValue)
})
obj.count++

const state = reactive({
  someObject: {
    age: 19
  }
})

// 侦听响应式对象的属性时，只有对象被替换时，才会被侦听到
watch(
  () =&gt; state.someObject,
  (newValue, oldValue) =&gt; {
    // console.log(&#39;响应式侦听&#39;, newValue, oldValue)
  },
  {
    // 开启深层侦听
    deep: true,
    // 创建侦听器时立即调用
    immediate: true
  }
)

state.someObject.age++ // 如未开启深层侦听，则无法被侦听到
// 直接修改对象
/*state.someObject = {
  age: 12
}*/

console.log(&#39;-----------watchEffect-------------&#39;)

const id = ref(1)
const data = ref(null)

// 侦听id发生变化则进行发送请求
watch(id, async () =&gt; {
  const response = await fetch(`https://jsonplaceholder.typicode.com/todos/${id.value}`)
  data.value = await response.json()
}, {
  // immediate: true
})

// 这个侦听方法不需要指定immediate，他会自动跟踪id，类似计算属性
/*
watchEffect(async () =&gt; {
  const response = await fetch(`https://jsonplaceholder.typicode.com/todos/${id.value}`)
  data.value = await response.json()
}, {
  // 如果需要在访问到更新之后的dom
  flush: &#39;post&#39;
})
*/

// 后置刷新， flush 的简写
watchPostEffect(() =&gt; {
})

setTimeout(() =&gt; {
  // 异步回调中监听需要手动取消侦听
  const unWatch = watchEffect(() =&gt; {
  })
  // 停止侦听
  unWatch()
}, 100)

</code></pre>
<h3 id="props-">Props传参</h3>
<p>组件</p>
<pre><code class="lang-VUE"> &lt;MyProps foo=&quot;Props测试传值&quot; title=&quot;这是标题&quot; :bar=&quot;10&quot; /&gt;
</code></pre>
<h4 id="-">父传子</h4>
<pre><code class="lang-ts">const props = defineOptions({
  title: {
    type: String,
    default: &#39;default&#39;
  }
})

console.log(props)

// 使用数组的形式
const props = defineProps([&#39;foo&#39;])

// 使用对象的形式
defineProps({
  foo: String,
  title: String,
  bar: Number,
  author: Person
})

// 使用对象形式的复杂配置
const props = defineProps({
  foo: {
    // 指定类型
    type: [String, Number],
    // 必传项
    required: true,
    validator(value: unknown): boolean {
      // 这里可以对参数进行校验
      return typeof value === &#39;string&#39;
    }
  },
  title: {
    type: String,
    // 指定默认值
    default: &#39;这是标题&#39;
  },
  bar: {
    type: Number
  },
  obj: {
    type: Object,
    // 对于对象类型，需要使用default方法进行配置默认值
    default(): object {
      return {
        message: &#39;123&#39;
      }
    }
  },
  fun: {
    type: Function,
    default() {
      // 函数的默认值
      // console.log(&#39;123&#39;)
    }
  },
  // person: Person
})

// 使用ts的泛型类型
defineProps&lt;{
  foo: string
  title: string
  bar?: number // 表示可不传
}&gt;()


import type { PropType } from &#39;vue&#39;

interface Props {
  foo: string | number
  title: string
  bar?: number
  obj: Object
}

// 使用接口方式进行定义泛型类型
defineProps&lt;Props&gt;()
// const obj2 = {message: &#39;123&#39;}
// 泛型类型进行定义默认值
withDefaults(defineProps&lt;Props&gt;(), {
  foo: &#39;默认值&#39;,
  obj: () =&gt; ({ message: &#39;123&#39; })
})

interface Book {
  name: &#39;三国演义&#39;,
  year: number
}

// 定义复杂类型
defineProps&lt;{
  book: Book
}&gt;()

// 复杂类型的运行时声明
const props = defineProps&gt;({
  book: Object as PropType&lt;Book&gt;
})

// console.log(&#39;MyProps: &#39;, props)
</code></pre>
<h4 id="-">子传父</h4>
<p>子组件定义</p>
<pre><code class="lang-ts">// 子向父传递事件
// 数组形式定义
const emit = defineEmits([&#39;large-text&#39;, &#39;small-text&#39;])
// 选项式定义
const emit = defineEmits({
  largeText(payload) {
    // 对触发事件参数进行验证
    console.log(&#39;largeText: &#39;, payload)
    return true
  },
  smallText(payload) {
    return true
  }
})

// 使用泛型类型
const emit = defineEmits&lt;{
  (e: &#39;largeText&#39;, value: number): void
  (e: &#39;smallText&#39;, value: number): void
}&gt;()
</code></pre>
<p>使用</p>
<pre><code class="lang-ts">function bigText() {
  emit(&#39;largeText&#39;, 0.5)
}

function smallText() {
  emit(&#39;smallText&#39;, 0.3)
}
</code></pre>
<p>子组件</p>
<pre><code class="lang-vue">&lt;button @click=&quot;$emit(&#39;largeText&#39;, 1)&quot;&gt;放大文本&lt;/button&gt;
&lt;button @click=&quot;bigText&quot;&gt;放大文本2&lt;/button&gt;
&lt;button @click=&quot;smallText&quot;&gt;缩小文本&lt;/button&gt;
</code></pre>
<p>父组件</p>
<pre><code class="lang-vue"> &lt;div :style=&quot;{fontSize: fontSize + &#39;em&#39;}&quot;&gt;
      &lt;MyComponent 
                   @largeText=&quot;args =&gt; fontSize += args&quot; 
                   @smallText=&quot;args =&gt; fontSize -= args&quot; /&gt;
   &lt;/div&gt;
</code></pre>
<p>暴露组件属性</p>
<pre><code class="lang-ts">defineExpose({
  name: &#39;东宇&#39;,
  open: () =&gt; {
    console.log(&#39;test....&#39;)
  }
})
</code></pre>
<h4 id="-">兄弟</h4>
<p>A组件</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import Bus from &#39;@/Bus&#39;

let flag = false
const emmitB = () =&gt; {
  flag = !flag
  Bus.emit(&#39;on-click&#39;, flag)
}
&lt;/script&gt;

&lt;template&gt;
&lt;div&gt;
  &lt;h1&gt;兄弟组件传参&lt;/h1&gt;
  &lt;h3&gt;A组件&lt;/h3&gt;
  &lt;button @click=&quot;emmitB&quot;&gt;派发一个事件&lt;/button&gt;
&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>B组件</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import Bus from &#39;@/Bus&#39;
import { ref } from &#39;vue&#39;

const Flag = ref(false)

Bus.on(&#39;on-click&#39;, (flag: boolean) =&gt; {
  Flag.value = flag
})
&lt;/script&gt;

&lt;template&gt;
&lt;div class=&quot;B&quot;&gt;
  &lt;h3&gt;B组件&lt;/h3&gt;
  {{Flag}}
&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>实现消息订阅与发布</p>
<pre><code class="lang-ts">type BusClass = {
  emit: (name: string) =&gt; void
  on: (name: string, callback: Function) =&gt; void
}

type ParamsKey = string | null | symbol

type List = {
  [key: ParamsKey]: Array&lt;Function&gt;
}

class Bus implements BusClass {

  list: List

  constructor() {
    this.list = {}
  }

  emit(name: string, ...args: Array&lt;any&gt;) {
    const eventName: Array&lt;Function&gt; = this.list[name]
    eventName.forEach(fn =&gt; {
      fn.apply(this, args)
    })
  }
  on(name: string, callback: Function) {
    const fn: Array&lt;Function&gt; = this.list[name] || []
    fn.push(callback)
    this.list[name] = fn
  }
}

export default new Bus()
</code></pre>
<h4 id="mitt">mitt</h4>
<p>1.全局挂载</p>
<pre><code class="lang-ts">const Mit = mitt()
const app = createApp(App)

// ts相关
declare module &#39;vue&#39; {
  export interface ComponentCustomProperties {
    $Bus: typeof Mit
  }
}

// 挂载到全局中
app.config.globalProperties.$Bus = Mit
</code></pre>
<p>2.按需引入</p>
<pre><code class="lang-ts">import mitt from &#39;mitt&#39;

const emitter = mitt()
export default emitter
</code></pre>
<p>A组件</p>
<pre><code class="lang-ts">import { getCurrentInstance } from &#39;vue&#39;

// 获取组件实例
const instance =  getCurrentInstance()

// 发送消息
instance?.proxy?.$Bus.emit(&#39;on-click&#39;, &#39;mitt&#39;)

const Bus = (str: any) =&gt; {
  console.log(str)
}

instance?.proxy?.$Bus.on(&#39;on-click&#39;, Bus)

// 取消监听
instance?.proxy?.$Bus.off(&#39;on-click&#39;, Bus)

// 清除全部监听
instance?.proxy.$Bus.all.clear()
</code></pre>
<p>B组件</p>
<pre><code class="lang-ts">// 接收消息
instance?.proxy?.$Bus.on(&#39;on-click&#39;, (str: string) =&gt; {
  console.log(str)
})
// 接收全部消息
instance?.proxy?.$Bus.on(&#39;*&#39;, (type: string, str: string) =&gt; {
  console.log(type, str)
})
</code></pre>
<h3 id="-">递归组件</h3>
<p>定义数据类型</p>
<pre><code class="lang-ts">interface Tree {
  name: string,
  checked: boolean,
  children?: Tree[]
}
</code></pre>
<p>定义数据源</p>
<pre><code class="lang-ts">const treeList = reactive&lt;Tree[]&gt;([
  {
    name: &#39;1&#39;,
    checked: false,
    children: [
      {
        name: &#39;1-1&#39;,
        checked: true
      }
    ]
  },
  {
    name: &#39;2&#39;,
    checked: true,
  },
  {
    name: &#39;3&#39;,
    checked: false,
    children: [
      {
        name: &#39;3-1&#39;,
        checked: true,
        children: [
          {
            name: &#39;3-1-1&#39;,
            checked: true
          }
        ]
      }
    ]
  }
])
</code></pre>
<p>开始遍历显示</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
interface Tree {
  name: string,
  checked: boolean,
  children?: Tree[]
}

defineProps&lt;{
  data: Tree[]
}&gt;()

const click = (tree: Tree, event: Event) =&gt; {
  console.log(tree, event)
}
&lt;/script&gt;

&lt;template&gt;
&lt;div @click.stop=&quot;click(item, $event)&quot; v-for=&quot;(item, index) in data&quot; :key=&quot;index&quot; style=&quot;margin-left: 10px;&quot;&gt;
  &lt;input v-model=&quot;item.checked&quot; type=&quot;checkbox&quot; name=&quot;cb&quot; id=&quot;&quot;&gt;
  &lt;span&gt;{{item.name}}&lt;/span&gt;
  &lt;Tree v-if=&quot;item?.children?.length&quot; :data=&quot;item?.children ?? []&quot;/&gt;
&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<blockquote>
<p>?表示属性不存在时就返回undefined</p>
<p>??表示如果之前为null或undefined时，则返回后面的值</p>
</blockquote>
<h3 id="-">动态组件</h3>
<p>具体实现</p>
<pre><code class="lang-ts">const components = reactive([
  {
    title: &#39;只因你太美&#39;,
    com: markRaw(Inject)
  },
  {
    title: &#39;来呀来呀充八万&#39;,
    com: markRaw(Store)
  },
  {
    title: &#39;充钱你才能变得更强&#39;,
    com: markRaw(MyTransitionGroup)
  }
])

const current = ref(components[0].com)
const active = ref(0)

const switchTab = (com: any, index: number) =&gt; {
  active.value = index
  current.value = com
}
</code></pre>
<p><strong>markRaw 标记会原始对象，将不会具备响应式功能</strong></p>
<p>组件内容</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;div style=&quot;display: flex;&quot;&gt;
      &lt;div @click=&quot;switchTab(item.com, index)&quot; v-for=&quot;(item, index) in components&quot; :key=&quot;index&quot; class=&quot;tab&quot; :class=&quot;[active === index ? &#39;active&#39; : &#39;&#39;]&quot;&gt;
        {{ item.title }}
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;component :is=&quot;current&quot; /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 id="-">插槽</h3>
<p>定义插槽</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;插槽&lt;/h2&gt;
    &lt;button&gt;
      &lt;!-- 定义一个默认的插槽 --&gt;
      &lt;!--   如果父组件没有提供任何的插槽内容，则将使用此处插槽内部定义的默认内容   --&gt;
      &lt;slot&gt;Submit&lt;/slot&gt;
    &lt;/button&gt;
    &lt;!-- 具名插槽   --&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;header&gt;
        &lt;!--   通过name属性定义插槽的名字     --&gt;
        &lt;slot name=&quot;header&quot; :count=&quot;1&quot;&gt;&lt;/slot&gt;
      &lt;/header&gt;
      &lt;main&gt;
        &lt;slot&gt;&lt;/slot&gt;
      &lt;/main&gt;
      &lt;footer&gt;
        &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;
      &lt;/footer&gt;
    &lt;/div&gt;
    &lt;ul&gt;
      &lt;li v-for=&quot;item in items&quot; :key=&quot;item.name&quot;&gt;
        &lt;!--    通过v-bind将插槽的数据传递给app组件    --&gt;
        &lt;slot name=&quot;item&quot; v-bind=&quot;item&quot;&gt;&lt;/slot&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>组件</p>
<pre><code class="lang-vue">&lt;MySlot&gt;
      &lt;!--   插槽名可以动态进行修改   --&gt;
      &lt;template v-slot:[slotName]=&quot;slotProps&quot;&gt;
        &lt;!--    header插槽的内容    --&gt;
        &lt;!--    接收由子组件插槽传递过来的参数    --&gt;
        &lt;span&gt;Header {{ slotProps.count }}&lt;/span&gt;
      &lt;/template&gt;
      &lt;!--  &lt;template #default&gt;
              &lt;div&gt;内容&lt;/div&gt;
            &lt;/template&gt;--&gt;
      &lt;!--  默认插槽无需使用template进行包裹   --&gt;
      &lt;div&gt;内容&lt;/div&gt;
      &lt;template #footer&gt; Footer&lt;/template&gt;
      &lt;template #item=&quot;{ name, age }&quot;&gt;
        &lt;p&gt;{{ name }}&lt;/p&gt;
        &lt;p&gt;{{ age }}&lt;/p&gt;
      &lt;/template&gt;
&lt;/MySlot&gt;
</code></pre>
<h3 id="-">异步组件</h3>
<p>定义异步组件</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;

const promise = new Promise&lt;string&gt;((resolve) =&gt; {
  setTimeout(() =&gt; {
    resolve(&#39;这是返回的数据&#39;)
  }, 3000)
})
const data = ref(&#39;&#39;)
const res: string = await promise
console.log(res)
data.value = res
&lt;/script&gt;

&lt;template&gt;
&lt;div&gt;
  {{ data}}
&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>实现异步加载效果</p>
<pre><code class="lang-ts">const SyncCom = defineAsyncComponent(() =&gt; import(&#39;@/components/SyncCom.vue&#39;))
</code></pre>
<pre><code class="lang-vue">&lt;Suspense&gt;
    &lt;template #default&gt;
        &lt;SyncCom/&gt;
    &lt;/template&gt;
    &lt;template #fallback&gt;
        &lt;div&gt;正在加载中...&lt;/div&gt;
    &lt;/template&gt;
&lt;/Suspense&gt;
</code></pre>
<h4 id="-">搭配路由使用</h4>
<pre><code class="lang-vue">&lt;RouterView v-slot=&quot;{ Component }&quot;&gt;
  &lt;template v-if=&quot;Component&quot;&gt;
    &lt;Transition mode=&quot;out-in&quot;&gt;
      &lt;KeepAlive&gt;
        &lt;Suspense&gt;
          &lt;!-- 主要内容 --&gt;
          &lt;component :is=&quot;Component&quot;&gt;&lt;/component&gt;

          &lt;!-- 加载中状态 --&gt;
          &lt;template #fallback&gt;
            正在加载...
          &lt;/template&gt;
        &lt;/Suspense&gt;
      &lt;/KeepAlive&gt;
    &lt;/Transition&gt;
  &lt;/template&gt;
&lt;/RouterView&gt;
</code></pre>
<h3 id="transition">Transition</h3>
<pre><code class="lang-vue">&lt;button @click=&quot;isShow = !isShow&quot;&gt;Toggle&lt;/button&gt;
&lt;Transition&gt;
    &lt;p v-if=&quot;isShow&quot;&gt;这是一段文本内容&lt;/p&gt;
&lt;/Transition&gt;
&lt;Transition name=&quot;fade&quot;&gt;
    &lt;p v-if=&quot;isShow&quot;&gt;这是fade动画&lt;/p&gt;
&lt;/Transition&gt;
&lt;Transition name=&quot;slide-fade&quot;&gt;
    &lt;p v-if=&quot;isShow&quot;&gt;这是slide-fade动画&lt;/p&gt;
&lt;/Transition&gt;
&lt;!--
    duration设置动画总时长
    appear 表示出现时就执行动画
    使用插槽可以实现可复用的动画效果
    使用插槽的组件的style标签不要加上scoped属性
    mode 指定模式，out-in表示先执行离开时动画在执行进入时动画
--&gt;
&lt;Transition name=&quot;bounce&quot; :duration=&quot;{enter: 800, leave: 700}&quot;
            @leave=&quot;onLeave&quot; appear mode=&quot;out-in&quot;&gt;
    &lt;p v-if=&quot;isShow&quot; style=&quot;text-align: center&quot;&gt;Animation动画&lt;/p&gt;
&lt;/Transition&gt;
</code></pre>
<p>css定义</p>
<p>根据<strong>name</strong>属性定义css选择器</p>
<blockquote>
<p>xxx-enter-from 节点动画进入开始时</p>
<p>xxx-enter-active 节点动画进行时</p>
<p>xxx-enter-to 节点动画结束时</p>
<p>xxx-leave-from 节点移除动画开始时</p>
<p>xxx-leave-active 节点移除动画进行时</p>
<p>xxx-leave-to 节点被移除时</p>
</blockquote>
<pre><code class="lang-css">&lt;style scoped&gt;
.v-enter-from,
.v-leave-to {
  opacity: 0;
}

.v-enter-active,
.v-leave-active {
  transition: opacity 0.5s ease-in-out;
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
}

.fade-enter-active,
.fade-leave-active {
  transition: opacity 0.8s ease-out;
}

/*离开和进入时的样式*/
.slide-fade-enter-from,
.slide-fade-leave-to {
  transform: translateX(40px);
  opacity: 0;
}

/* 插入时的动画*/
.slide-fade-enter-active {
  transition: all 0.3s ease-out;
}

/* 移除时的动画*/
.slide-fade-leave-active {
  transition: all 0.8s cubic-bezier(1, 0.5, 0.8, 1);
}

/* 插入时的动画*/
.bounce-enter-active {
  animation: bounce-in 0.5s;
}

/* 移除时的动画*/
.bounce-leave-active {
  animation: bounce-in 0.5s reverse;
}

@keyframes bounce-in {
  0% {
    transform: scale(0);
  }
  50% {
    transform: scale(1.25);
  }
  100% {
    transform: scale(1);
  }
}
&lt;/style&gt;
</code></pre>
<h3 id="transitiongroup">TransitionGroup</h3>
<p>使用方法</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;

const data = ref&lt;string[]&gt;([&#39;这是Item&#39;, &#39;我是一个标签哈哈哈&#39;, &#39;充八万了把&#39;])

function addItem() {
  const index: number = getIndex()
  data.value.splice(index, 0, &#39;addItem&#39; + index)
}

function deleteItem() {
  if (data.value.length === 0) return
  const index: number = getIndex()
  data.value.splice(index, 1)
}

function getIndex(): number {
  return Math.floor(Math.random() * data.value.length)
}

function reset() {
  data.value.sort(() =&gt; Math.random() - 0.5)
}

&lt;/script&gt;

&lt;template&gt;
&lt;div&gt;
  &lt;h2&gt;TransitionGroup&lt;/h2&gt;
  &lt;TransitionGroup name=&quot;list&quot; tag=&quot;ul&quot;&gt;
    &lt;li v-for=&quot;item in data&quot; :key=&quot;item&quot;&gt;
      {{ item }}
    &lt;/li&gt;
  &lt;/TransitionGroup&gt;
  &lt;button @click=&quot;addItem&quot;&gt;添加一项&lt;/button&gt;
  &lt;button @click=&quot;deleteItem&quot;&gt;删除一项&lt;/button&gt;
  &lt;button @click=&quot;reset&quot;&gt;重新排序&lt;/button&gt;
&lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;

.list-enter-from,
.list-leave-to {
  transform: translateX(40px);
  opacity: 0;
}

.list-move, /* 对移动中元素应用过渡 */
.list-enter-active,
.list-leave-active {
  transition: all 0.8s ease;
}

/* 确保将离开的元素从布局中删除
   以便能正确计算出移动的动画 */
.list-leave-active {
  position: absolute;
}
&lt;/style&gt;

</code></pre>
<h4 id="-">打乱组合动画</h4>
<pre><code class="lang-vue">&lt;TransitionGroup move-class=&quot;mmm&quot; tag=&quot;div&quot; class=&quot;wraps&quot;&gt;
    &lt;div class=&quot;items&quot; v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;
        {{ item.number}}
    &lt;/div&gt;
&lt;/TransitionGroup&gt;
&lt;button @click=&quot;random&quot;&gt;toggle&lt;/button&gt;
</code></pre>
<pre><code class="lang-ts">import _ from &#39;lodash&#39;

const list = ref(Array.apply(null, { length: 81 } as number[]).map((_, index) =&gt; {
  return {
    id: index,
    number: index % 9
  }
}))

const random = () =&gt; {
  list.value = _.shuffle(list.value)
}
</code></pre>
<pre><code class="lang-css">.wraps {
  display: flex;
  flex-wrap: wrap;
  width: calc(25px * 10 + 9px);
}

.wraps .items {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 25px;
  height: 25px;
  border: 1px solid #ccc;
}

.mmm {
  transition: all 1s;
}
</code></pre>
<p>状态动画</p>
<p><code>npm install gsap</code></p>
<pre><code class="lang-vue">&lt;input v-model=&quot;num.current&quot; step=&quot;20&quot; type=&quot;number&quot; name=&quot;&quot; id=&quot;&quot;&gt;
{{ num.tweenedNumber}}
</code></pre>
<pre><code class="lang-ts">import { gsap } from &#39;gsap&#39;

const num = reactive({
  current: 0,
  tweenedNumber: 0
})

watch(() =&gt; num.current, (newValue: number, oldValue: number) =&gt; {
  gsap.to(
    num,
    {
      duration: 1,
      tweenedNumber: newValue.toFixed(0)
    }
  )
})
</code></pre>
<h3 id="-">依赖注入</h3>
<p>根组件</p>
<pre><code class="lang-ts">// 应用层
provide&lt;string&gt;(/* 注入名 */&#39;message&#39;,/* 注入值 */ &#39;hello world&#39;)

const location = ref&lt;string&gt;(&#39;充八万&#39;)

function cong() {
  location.value = &#39;充好了&#39;
}

provide(&#39;location&#39;, {
  location,
  cong
})

// 值将不允许被修改
provide(&#39;read-only&#39;, readonly(location))
</code></pre>
<p>孙子组件</p>
<pre><code class="lang-ts">const message = inject&lt;string&gt;(&#39;message&#39;,/* 默认值 */ &#39;hello&#39;)
const { location, cong } = inject&lt;Ref&lt;string&gt; | Function&gt;(&#39;location&#39;)
</code></pre>
<h3 id="tsx-">tsx支持</h3>
<p>安装依赖</p>
<pre><code class="lang-bash">npm install @vitejs/plugin-vue-jsx -D
</code></pre>
<p>简单用法</p>
<pre><code class="lang-tsx">import {defineComponent} from &#39;vue&#39;

export default defineComponent({
  data() {
    return {
      age: 19
    }
  },
  render() {
    return (
      &lt;div&gt;{ this.age }&lt;/div&gt;
    )
  }
})
</code></pre>
<p>具体用法</p>
<pre><code class="lang-tsx">import { defineComponent, ref } from &#39;vue&#39;

interface Props {
  name?: string
}

const A = (_: any, {slots}) =&gt; (
  &lt;&gt;
    &lt;div&gt;{slots.default ? slots.default() : &#39;默认值&#39;}&lt;/div&gt;
    &lt;div&gt;{slots.foo?.()}&lt;/div&gt;
  &lt;/&gt;
)

export default defineComponent({
  props: {
    name: String
  },
  emits: [&#39;on-click&#39;],
  setup(props: Props, { emit }) {
    const flag = ref(false)
    // tsx需要手动解包
    // 不支持v-if
    // return () =&gt; (&lt;div v-show={flag.value}&gt;我是tsx&lt;/div&gt;)
    const data = [
      {
        name: &#39;dongyu1&#39;
      },
      {
        name: &#39;dongyu2&#39;
      }
    ]
    /*return () =&gt; (
      &lt;&gt;
        &lt;div&gt;{flag.value ? &lt;div&gt;true&lt;/div&gt;: &lt;div&gt;false&lt;/div&gt;}&lt;/div&gt;
      &lt;/&gt;
    )*/

    const fn = (item: any) =&gt; {
      console.log(item)
      emit(&#39;on-click&#39;, item.name)
    }

    const slot = {
      default: () =&gt; (&lt;div&gt;default slots&lt;/div&gt;),
      foo: () =&gt; (&lt;div&gt;foo slots&lt;/div&gt;)
    }

    const v = ref&lt;string&gt;(&#39;&#39;)
    return () =&gt; (
      &lt;&gt;
        &lt;input type=&quot;text&quot; v-model={v.value} /&gt;
        &lt;div&gt;{v.value}&lt;/div&gt;
        &lt;hr/&gt;
        &lt;div&gt;{props.name}&lt;/div&gt;
        &lt;hr/&gt;
        &lt;A v-slots={slot}&gt;&lt;/A&gt;
        &lt;hr/&gt;
        {
          data.map(item =&gt; {
            return &lt;div onClick={() =&gt; fn(item)}&gt;{item.name}&lt;/div&gt;
          })
        }
      &lt;/&gt;
    )
  }
})
</code></pre>
<h3 id="-pinia-">状态管理(Pinia)</h3>
<p>npm安装<strong><a href="[Pinia | The intuitive store for Vue.js (vuejs.org">pinia</a>](<a href="https://pinia.vuejs.org/zh/)">https://pinia.vuejs.org/zh/)</a>)</strong></p>
<p><code>npm install pinia</code></p>
<p>main.ts 安装插件</p>
<pre><code class="lang-ts">import { createPinia } from &#39;pinia&#39;
const app = createApp(App)
app.use(createPinia())
</code></pre>
<p>配置store（counter.ts）</p>
<pre><code class="lang-ts">import { defineStore } from &#39;pinia&#39;

// 使用一个对象来定义store
/*
export const useCounterStore = defineStore(&quot;counter&quot;, {
  state: () =&gt; ({count: 0}),
  actions: {
    increment() {
      this.count++
    }
  }
})
*/

// 使用一个函数定义store
/*
export const useCounterStore = defineStore(&#39;counter&#39;, () =&gt; {
  const count = ref(0)

  function increment() {
    count.value++
  }

  return {
    count, increment
  }
})
*/

/**
* ts 定义类型
*/
interface State {
  count: number
  items: Item[]
  userinfo: UserInfo | null
}

interface UserInfo {
  username: string
  password: string
}

interface Item {
  name: string
  email: string
}

// 向外导出store
// 组合式
export const useCounterStore = defineStore(&#39;counter&#39;, {
  state: (): State =&gt; ({ count: 0, userinfo: null, items: []}),
  getters: {
    double: (state) =&gt; state.count * 2
  },
  actions: {
    increment() {
      this.count++
    }
  }
})
</code></pre>
<p>使用</p>
<pre><code class="lang-vue">&lt;script lang=&quot;ts&quot; setup&gt;
import { useCounterStore } from &#39;@/stores/counter&#39;

const counter = useCounterStore()

// 订阅
counter.$subscribe((mutation, state) =&gt; {
  console.log(mutation, state)
  mutation.type // &#39;direct&#39; | &#39;patch object&#39; | &#39;patch function&#39;
  // 和 cartStore.$id 一样
  mutation.storeId // &#39;cart&#39;
  // 只有 mutation.type === &#39;patch object&#39;的情况下才可用
  mutation.payload // 传递给 cartStore.$patch() 的补丁对象。

  // 每当状态发生变化时，将整个 state 持久化到本地存储。
  localStorage.setItem(&#39;cart&#39;, JSON.stringify(state))
}, {
    // 组件销毁时依然订阅
    detached: true,
    // 深度订阅
    deep: true,
    // 改变时机
    flush: &#39;post&#39;
})

// 直接使用变量进行自加一
counter.count++

// 使用内部方法进行自加一
counter.$patch({ count: counter.count + 1 })

// 使用actions进行自加一
counter.increment()

// 重置值
counter.$reset()

// 同时修改多个值
counter.$patch(state =&gt; {
  state.count = 1
  state.items.push({name: &#39;123&#39;, email: &#39;123&#39;})
})

counter.$state = {
   count: 1
}

const unsubscribe = counter.$OnAction(({
    name, // action 名称
    store, // store 实例，类似 `someStore`
    args, // 传递给 action 的参数数组
    after, // 在 action 返回或解决后的钩子
    onError, // action 抛出或拒绝的钩子
  }) =&gt; {
    console.log(arg)
    // 这将在 action 成功并完全运行后触发。
    // 它等待着任何返回的 promise
    after((result) =&gt; {
        console.log(&#39;after&#39;)
    })

    // 如果 action 抛出或返回一个拒绝的 promise，这将触发
    onError((error) =&gt; {
      console.warn(
        `Failed &quot;${name}&quot; after ${Date.now() - startTime}ms.\nError: ${error}.`
      )
    })
})

// 手动取消订阅
unsubscribe()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;{{ counter.count }}
    {{ counter.items }}
    &lt;button @click=&quot;counter.count ++&quot;&gt;+1&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h4 id="-">一些问题</h4>
<p>结构store对象的值将不再具备响应式，所以通常将store对象转换成ref</p>
<pre><code class="lang-ts">const {count} = storeToRefs(Test)
</code></pre>
<h4 id="-">持久化数据</h4>
<pre><code class="lang-ts">type Options = {
  key: string
}

// 默认key
const __piniaKey__: string = &#39;dongyu&#39;

// 保存数据到本地
const setStorage = (key: string, value: any) =&gt; {
  localStorage.setItem(key, JSON.stringify(value))
}

// 从本地获取数据
const getStorage = (key: string) =&gt; {
  const value = localStorage.getItem(key)
  return value ? JSON.parse(value as string) : {}
}

// 插件
const piniaPlugin = (options: Options) =&gt; {
  return (context: PiniaPluginContext) =&gt; {
    const {store} = context
    // 首先先从本地获取数据
    const data = getStorage(`${options?.key ?? __piniaKey__}-${store.$id}`)
    // 监听store数据变化
    store.$subscribe(() =&gt; {
      console.log(&#39;change&#39;)
      // 通过对应id保存至本地
      // 注意，选项式需要使用toRaw(store.$state)
      setStorage(`${options?.key ?? __piniaKey__}-${store.$id}`, store.$state) 
    })
    // 返回数据并挂载到store上
    return {
      ...data
    }
  }
}

const pinia = createPinia()
app.use(pinia)
// 注册一个插件
pinia.use(piniaPlugin({
  key: &#39;pinia&#39;
}))
</code></pre>
<h3 id="v-model">V-Model</h3>
<p><strong>双向数据绑定</strong></p>
<p>组件中定义</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { computed } from &#39;vue&#39;

// v-model:title 表示指定一个参数
const props = defineProps({
  modelValue: String,
  // v-model 修饰符
  modelModifiers?: {
    big: boolean,
    // 指定一个默认值
    default: () =&gt; ({
      big: false
    })
  }
}) // modelValue是父组件v-model传递的属性，固定写法
const emit = defineEmits([&#39;update:modelValue&#39;]) // 更新属性值，固定写法

const value = computed({
  get() {
    return props.modelValue
  },
  set: function(val) {
    console.log(val)
    const { big } = props.modelModifiers
    if (big) {
      // console.log(props.modelModifiers)
    }
    emit(&#39;update:modelValue&#39;, val)
  }
})

const change = (e: Event) =&gt; {
  emit(&#39;update:modelValue&#39;, (e.target as HTMLInputElement).value)
}

&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;h2&gt;V-Model&lt;/h2&gt;
    &lt;input type=&quot;text&quot; :value=&quot;modelValue&quot; @input=&quot;change&quot;&gt;
    &lt;input type=&quot;text&quot; v-model=&quot;value&quot;&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>父组件中用法</p>
<pre><code class="lang-vue">&lt;!--  v-model:title 给v-model指定一个参数，子组件接收属性名将为title  --&gt;
&lt;V-Model v-model.big=&quot;searchText&quot; /&gt;
&lt;div&gt;App组件: search: {{ searchText }}&lt;/div&gt;
</code></pre>
<h3 id="-">自定义指令</h3>
<pre><code class="lang-ts">// 定义一个自定义指令 v-focus
const vFocus: Directive = {
  created: (el, binding, vNode, prevVNode) =&gt; {
    // console.log(el, binding, vNode, prevVNode)
  },
  mounted: (el: HTMLInputElement) =&gt; {
    el.focus()
  },
  beforeUpdate() {},
  updated() {}
}

// 简写
const vFocus: Directive&lt;HTMLElement, string&gt; = (el, binding) =&gt; {

}
</code></pre>
<h4 id="-">实战用法</h4>
<p>可移动的标签</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import type { Directive, DirectiveBinding } from &#39;vue&#39;

const vMove: Directive&lt;any, void&gt; = (el: HTMLElement, binding: DirectiveBinding) =&gt; {
  const moveElement: HTMLDivElement = el.firstElementChild as HTMLDivElement
  console.log(moveElement)
  const mouseDown = (e: MouseEvent) =&gt; {
    // 鼠标按下时调用这个箭头函数
    let x = e.clientX - el.offsetLeft
    let y = e.clientY - el.offsetTop

    const move = (e: MouseEvent) =&gt; {
      console.log(e)
       // 具体移动的实现
      el.style.left = e.clientX - x + &#39;px&#39;
      el.style.top = e.clientY - y + &#39;px&#39;
    }
    // 监听鼠标移动事件
    document.addEventListener(&#39;mousemove&#39;, move)
    document.addEventListener(&#39;mouseup&#39;, () =&gt; {
      // 鼠标抬起时删除鼠标移动事件
      document.removeEventListener(&#39;mousemove&#39;, move)
    })
  }
  // 监听标题区域鼠标按下的事件
  moveElement.addEventListener(&#39;mousedown&#39;, mouseDown)
}
&lt;/script&gt;

&lt;template&gt;
&lt;div v-move class=&quot;box&quot;&gt;
  &lt;div class=&quot;header&quot;&gt;这是标题&lt;/div&gt;
  &lt;div&gt;内容&lt;/div&gt;
&lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.box {
  position: absolute;
  width: 400px;
  height: 200px;
  border: 1px solid black;
}

.header {
    cursor: move;
}
&lt;/style&gt;
</code></pre>
<p>图片懒加载</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import type {Directive} from &quot;vue&quot;
// glob 是懒加载的模式
// globEager 直接静态加载
const imageList: Record&lt;string, { default: string }&gt; = import.meta.glob(&#39;./assets/images/**&#39;, {eager: true})
// 对象转换成数组
const arr = Object.values(imageList).map(item =&gt; item.default)

const vLazy: Directive&lt;HTMLImageElement, string&gt; = async (el: HTMLImageElement, binding) =&gt; {
  // 默认占位图
  const def = await import(&#39;./assets/vue.svg&#39;)
  // 设置默认图片
  el.src = def.default
  const observer = new IntersectionObserver((entry) =&gt; {
    // 监听图片是否完全显示
    if (entry[0].intersectionRatio &gt; 0) {
      setTimeout(() =&gt; {
        // 需要加载的图片
        el.src = binding.value
      }, 1000)
      observer.unobserve(el)
    }
  })
  observer.observe(el)
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;img v-lazy=&quot;item&quot; v-for=&quot;(item, index) in arr&quot; :src=&quot;item&quot; :key=&quot;index&quot; alt=&quot;&quot; height=&quot;500&quot; width=&quot;350&quot;&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style lang=&quot;css&quot;&gt;
img {
  display: block;
}
&lt;/style&gt;
</code></pre>
<h3 id="-hooks">自定义hooks</h3>
<p>定义转换方法</p>
<pre><code class="lang-ts">import {onMounted} from &quot;vue&quot;

type Options = {
  el: string
}

export default function (options: Options): Promise&lt;{ baseUrl: string }&gt; {
  return new Promise((resolve) =&gt; {
    onMounted(() =&gt; {
      const img: HTMLImageElement = document.querySelector(options.el) as HTMLImageElement
      img.onload = () =&gt; {
        resolve({
          baseUrl: base64(img)
        })
      }
    })

    // 核心实现代码
    const base64 = (el: HTMLImageElement) =&gt; {
      const canvas = document.createElement(&#39;canvas&#39;)
      const context = canvas.getContext(&#39;2d&#39;)
      canvas.width = el.width
      canvas.height = el.height
      context?.drawImage(el, 0, 0, canvas.width, canvas.height)
      return canvas.toDataURL(&#39;image/png&#39;)
    }
  })
}
</code></pre>
<p>使用</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import useBase64 from &#39;./hooks&#39;

useBase64({
  el: &#39;#img&#39;
}).then(res =&gt; {
  console.log(res.baseUrl)
})

&lt;/script&gt;

&lt;template&gt;
  &lt;img src=&quot;./assets/images/1.png&quot; alt=&quot;&quot; id=&quot;img&quot;&gt;
&lt;/template&gt;
</code></pre>
<h4 id="-">综合案例</h4>
<h5 id="-">准备工作</h5>
<p>1.新建项目</p>
<p>2.创建src目录</p>
<p>3.src目录添加index.ts文件</p>
<p>4.执行命令</p>
<pre><code class="lang-bash">npm init -y #初始化项目
npm install -g typescript # 安装ts
npm install vue -D # 安装vue
npm install vite # 安装vite
tsc --init #初始化ts
</code></pre>
<p>5.添加文件:</p>
<p>​    <code>index.d.ts</code>    <code>vite.config.ts</code></p>
<p>开始 </p>
<p>index.ts</p>
<pre><code class="lang-ts">// MutationObserver 主要侦听子集的变化 还有属性的变化，以及增删改查
// ResizeObserver 主要侦听元素宽高的变化

import type { App } from &#39;vue&#39;

function useResize(el: HTMLElement, callback: Function) {
  const resize = new ResizeObserver((entries) =&gt; {
    callback(entries[0].contentRect)
  })
  resize.observe(el)
}

const install = (app: App) =&gt; {
   app.directive(&#39;resize&#39;, {
     mounted(el, binding) {
       useResize(el, binding.value)
     }
   })
}

useResize.install = install

export default useResize
</code></pre>
<p>vite.config.ts</p>
<pre><code class="lang-ts">import {defineConfig} from &quot;vite&quot;

export default defineConfig({
  build: {
    lib: {
      entry: &#39;src/index.ts&#39;,
      name: &#39;useResize&#39;
    },
    rollupOptions: {
      external: [&#39;vue&#39;],
      output: {
        globals: {
          useResize: &#39;useResize&#39;
        }
      }
    }
  }
})
</code></pre>
<p>index.d.ts</p>
<pre><code class="lang-ts">import {App} from &quot;vue&quot;

declare const useResize: {
  (el: HTMLElement, callback: Function): void
  install: (app: App) =&gt; void
}

export default useResize
</code></pre>
<p>package.json</p>
<blockquote>
<p>注意修改 name和version</p>
</blockquote>
<pre><code class="lang-json">{
  &quot;name&quot;: &quot;v-resize-jdy&quot;,
  &quot;version&quot;: &quot;0.1.2&quot;,
  &quot;description&quot;: &quot;2023-9-21&quot;,
  &quot;main&quot;: &quot;./dist/v-resize.umd.js&quot;,
  &quot;module&quot;: &quot;dist/v-resize.mjs&quot;,
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;vite build&quot;,
    &quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;
  },
  &quot;keywords&quot;: [],
  &quot;author&quot;: &quot;jdy2002&quot;,
  &quot;files&quot;: [
    &quot;dist&quot;,
    &quot;index.d.ts&quot;
  ],
  &quot;license&quot;: &quot;ISC&quot;,
  &quot;devDependencies&quot;: {
    &quot;vite&quot;: &quot;^4.4.9&quot;,
    &quot;vue&quot;: &quot;^3.3.4&quot;
  }
}
</code></pre>
<p>运行 <code>npm run build</code> 生成dist文件</p>
<p>打包发布到npm</p>
<pre><code class="lang-bash">npm login #登录npm
npm publish #发布
</code></pre>
<h5 id="-">在项目中使用</h5>
<p>1.安装依赖</p>
<pre><code class="lang-bash">npm install v-resize-jdy
</code></pre>
<p>2.安装自定义指令插件</p>
<pre><code class="lang-ts">import useResize from &quot;v-resize-jdy&quot;

// 在main.ts中使用插件
createApp(App)
  .use(useResize)
</code></pre>
<p>3.使用</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import useResize from &quot;v-resize-jdy&quot;
import {onMounted} from &quot;vue&quot;

// 1.直接引入使用
/*onMounted(() =&gt; {
  useResize(document.querySelector(&#39;#resize&#39;) as HTMLElement, (e: any) =&gt; {
    console.log(e)
  })
})*/

const resizeCallback = (e: any) =&gt; {
  console.log(e)
}
&lt;/script&gt;

&lt;template&gt;
  &lt;!-- 2.自定义指令实现 --&gt;
  &lt;div v-resize=&quot;resizeCallback&quot; id=&quot;resize&quot;&gt;&lt;/div&gt;
&lt;/template&gt;

&lt;style lang=&quot;css&quot;&gt;
#resize {
  width: 300px;
  height: 300px;
  background-color: pink;
  border: 1px solid #ccc;
  resize: both;
  overflow: hidden;
}
&lt;/style&gt;
</code></pre>
<h3 id="-">全局函数和变量</h3>
<p>main.ts</p>
<pre><code class="lang-ts">const app = createApp(App)

// 配置全局变量 $dev
app.config.globalProperties.$dev = &#39;dev&#39;
// 配置全局函数 format
app.config.globalProperties.$filters = {
  format&lt;T&gt; (str: T) {
    return `东宇-${str}`
  }
}

// ts支持
type Filter = {
  format&lt;T&gt;(str: T): string
}

declare module &#39;vue&#39; {
  export interface ComponentCustomProperties {
    $filters: Filter,
    $dev: string
  }
}
</code></pre>
<p>组件中使用</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { getCurrentInstance } from &#39;vue&#39;

// 获取实例对象
const app = getCurrentInstance()
// 使用
console.log(app?.proxy?.$filters.format(&#39;ts&#39;))
&lt;/script&gt;
&lt;template&gt;
    &lt;!-- 直接使用 --&gt;
    &lt;div&gt;{{$filters.format(&#39;的飞机&#39;)}}&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 id="-plugin-">插件(Plugin)</h3>
<p>实现全局加载插件</p>
<p>定义加载布局</p>
<pre><code class="lang-vue">&lt;template&gt;
    &lt;!-- 通过v-if实现显示隐藏效果 --&gt;
    &lt;div v-if=&quot;isShow&quot;&gt;Loading...&lt;/div&gt;
&lt;/template&gt;

&lt;script setup lang=&#39;ts&#39;&gt;
import { ref } from &#39;vue&#39;
// 这个响应式属性控制显示和隐藏
const isShow = ref&lt;boolean&gt;(false)

/**
* 用两个方法来控制
*/
const show = () =&gt; {
  isShow.value = true
}

const hide = () =&gt; {
  isShow.value = false
}

// 向外导出显示和隐藏方法
defineExpose({
  show,
  hide,
  isShow
})

&lt;/script&gt;

&lt;style scoped&gt;
div {
    position: absolute;
    left: 50%;
    top: 50%;
    padding: 10px 40px;
    background-color: rgba(255, 255, 255, .3);
    box-shadow: 1px 1px 2px 2px rgba(0, 0, 0, .3);
    border-radius: 16px;
    transform: translate(-50%, -50%);
}
&lt;/style&gt;
</code></pre>
<p>定义插件</p>
<pre><code class="lang-ts">import type { App, VNode } from &#39;vue&#39;
import Loading from &#39;./index.vue&#39;

import { createVNode, render } from &#39;vue&#39;

export default {
  // 必须使用这个install方法
  install(app: App) {
    // 构建成虚拟dom
    const vNode: VNode = createVNode(Loading)
    console.log(vNode)
    // 渲染到body中
    render(vNode, document.body)
    // 把显示和隐藏方法挂载到vue全局属性中
    app.config.globalProperties.loading = {
        show: vNode.component?.exposed?.show,
        hide: vNode.component?.exposed?.hide
    }
  }
}
</code></pre>
<p>安装插件</p>
<pre><code class="lang-ts">import Loading from &#39;./components/Loading&#39;

const app = createApp(App)
// 安装插件
app.use(Loading)

// 解决找不到属性报错的问题
type Lod = {
  show: () =&gt; void,
  hide: () =&gt; void
}

declare module &#39;vue&#39; {
  export interface ComponentCustomProperties {
    loading: Lod
  }
}
</code></pre>
<p>使用</p>
<pre><code class="lang-vue">&lt;script lang=&quot;ts&quot;&gt;
import { getCurrentInstance } from &#39;vue&#39;

// 获取到vue实例
const instance = getCurrentInstance()

// 延迟隐藏
setTimeout(() =&gt; {
  instance?.proxy?.loading.hide()
}, 5000)

// 显示
instance?.proxy?.loading.show()
&lt;/script&gt;
</code></pre>
<h3 id="elementui-">ElementUI自动导入</h3>
<p>准备工作</p>
<p><strong>npm install -D unplugin-auto-import</strong> # 支持自动导入</p>
<pre><code class="lang-bash">npm install -D unplugin-icons # 自动导入Icon
npm install -D @iconify-json/ep # 安装图标库（https://icones.netlify.app/）
npm install -D unplugin-vue-components # 自动导入组件
</code></pre>
<p>tsconfig.json</p>
<pre><code class="lang-json">&quot;include&quot;: [&quot;env.d.ts&quot;, &quot;src/**/*&quot;, &quot;src/**/*.vue&quot;, &quot;src/**/*.ts&quot;]
&quot;compilerOptions&quot;: {
   &quot;types&quot;: [&quot;vite/client&quot;, &quot;element-plus/global&quot;, &quot;unplugin-icons/types/vue&quot;]
}
</code></pre>
<p>vite.config.ts</p>
<pre><code class="lang-ts">import { fileURLToPath, URL } from &#39;node:url&#39;

import { defineConfig } from &#39;vite&#39;
import vue from &#39;@vitejs/plugin-vue&#39;

import AutoImport from &#39;unplugin-auto-import/vite&#39;
import Components from &#39;unplugin-vue-components/vite&#39;
import { ElementPlusResolver } from &#39;unplugin-vue-components/resolvers&#39;

import Icons from &#39;unplugin-icons/vite&#39;
import IconsResolver from &#39;unplugin-icons/resolver&#39;

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [
    vue(),
    AutoImport({
      // 需要自动导入的文件
      include: [/\.[tj]sx?$/, /\.vue$/],
      // 解析器，支持UI组件库自动导入
      resolvers: [
        ElementPlusResolver(),
        // 自动导入图标组件
        // IconsResolver({
        //   prefix: &#39;Icon&#39;
        // })
      ],
      // 自动导入的文件名
      imports: [&#39;vue&#39;],
      // 指定生成.d.ts的位置
      dts: &#39;src/auto-imports.d.ts&#39;
    }),
    Components({
      resolvers: [
        // 自动注册图标组件
        IconsResolver({
          prefix: &#39;&#39;, // 默认前缀是i
          enabledCollections: [&#39;ep&#39;] // 选择图标库集合 ep
        }),
        ElementPlusResolver(),
      ],
      // 需要自动导入组件的目录
      dirs: [&#39;src/components&#39;, &#39;src/views&#39;],
      // 文件后缀
      extensions: [&#39;vue&#39;],
      // 指定.d.ts生成的位置
      dts: &#39;src/components.d.ts&#39;,
      // 深度扫描
      deep: true,
      // 需要自动导入的文件
      include: [/.vue$/, /.vue?vue/]
    }),
    Icons({
      autoInstall: true, // 自动安装
    })
  ],
  resolve: {
    alias: {
      &#39;@&#39;: fileURLToPath(new URL(&#39;./src&#39;, import.meta.url))
    }
  }
})
</code></pre>
<p>组件中使用</p>
<pre><code class="lang-vue">&lt;EpApple /&gt;

&lt;ep-add-location /&gt;

&lt;EpRefresh /&gt;
</code></pre>
<p>无需进行手动导入</p>
<h3 id="css-">CSS相关</h3>
<h4 id="scope-">scope样式穿透</h4>
<p>1.给HTML的DOM节点加一个不重复data属性(形如：data-v-123)来表示他的唯一性
2.在每句css选择器的末尾（编译后的生成的css语句）加一个当前组件的data属性选择器（如[data-v-123]）来私有化样式
3.如果组件内部包含有其他组件，只会给其他组件的最外层标签加上当前组件的data属性</p>
<p>不适用:deep</p>
<pre><code class="lang-css">#hello .green {
  background-color: red;
}
</code></pre>
<p>转换之后</p>
<pre><code class="lang-css">#hello .green[data-v-7a7a37b1] {
  background-color: red;
}
</code></pre>
<hr>
<p>使用:deep</p>
<pre><code class="lang-css">#hello :deep(.green) {
  background-color: red;
}
</code></pre>
<p>转换之后</p>
<pre><code class="lang-css">#hello[data-v-7a7a37b1] .green {
  background-color: red;
}
</code></pre>
<p><strong>使用之后会把data-v属性前移</strong></p>
<h4 id="-">插槽选择器</h4>
<p>父组件</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import A from &#39;@/components/A.vue&#39;
&lt;/script&gt;

&lt;template&gt;
  &lt;A&gt;
    &lt;div class=&quot;a&quot;&gt;我是充八万&lt;/div&gt;
  &lt;/A&gt;
&lt;/template&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</code></pre>
<p>子组件A.vue</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div&gt;
  我是插槽
  &lt;slot&gt;&lt;/slot&gt;
&lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
:slotted(.a) {
  color: red;
}
&lt;/style&gt;
</code></pre>
<p>如果要在子组件中修改插槽中的内容，需要添加<code>:slotted(选择器)</code></p>
<h4 id="-">全局选择器</h4>
<pre><code class="lang-css">&lt;style scoped&gt;
:global(div) {
  color: pink;
}
&lt;/style&gt;
</code></pre>
<p>global修饰的选择器将是全局生效的</p>
<h4 id="-css">动态CSS</h4>
<p>使用v-bind动态绑定css属性值</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;

const color = ref(&#39;pink&#39;)
&lt;/script&gt;

&lt;template&gt;
  &lt;div class=&quot;div&quot;&gt;
    动态css
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.div {
  color: v-bind(color);
}
&lt;/style&gt;
</code></pre>
<p>通过对象形式动态修改</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { ref } from &#39;vue&#39;

const style = ref({
  color: &#39;blue&#39;
})

setTimeout(() =&gt; {
  style.value.color = &#39;skyblue&#39;
}, 2000)
&lt;/script&gt;

&lt;template&gt;
  &lt;div class=&quot;div&quot;&gt;
    动态css
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;
.div {
  color: v-bind(&#39;style.color&#39;);
}
&lt;/style&gt;
</code></pre>
<p>module形式</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div :class=&quot;[dy.div, dy.border]&quot;&gt;
    动态css
  &lt;/div&gt;
&lt;/template&gt;

&lt;style module=&quot;dy&quot;&gt;
.div {
  color: red;
}

.border {
  border: 1px solid #ccc;
}
&lt;/style&gt;
</code></pre>
<p>script中使用</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { useCssModule } from &#39;vue&#39;

const css = useCssModule(&#39;dy&#39;)
console.log(css)
&lt;/script&gt;
</code></pre>
<h3 id="-tailwindcss">集成TailWindCSS</h3>
<p>安装</p>
<pre><code class="lang-bash">npm install -D tailwindcss postcss autoprefixer
</code></pre>
<p>生成配置文件</p>
<pre><code class="lang-bash">npx tailwindcss init -p
</code></pre>
<p>修改配置文件tailwind.config.js</p>
<pre><code class="lang-js">module.exports = {
  content: [&#39;./index.html&#39;, &#39;./src/**/*.{vue,js,ts,jsx,tsx}&#39;],
  theme: {
    extend: {},
  },
  plugins: [],
}
</code></pre>
<p>src目录下创建index.css</p>
<pre><code class="lang-css">@tailwind base;
@tailwind components;
@tailwind utilities;
</code></pre>
<p>在main.ts中引入</p>
<pre><code class="lang-ts">import &#39;./index.css&#39;
</code></pre>
<p>使用</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div class=&quot;w-screen h-screen bg-red-600 flex justify-center items-center text-8xl text-slate-200&quot;&gt;
    hello tailwind
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>重新运行项目即可生效</p>
<h3 id="nexttick">nextTick</h3>
<p>vue更新dom是异步的 数据更新是同步的
我们本次更新代码是同步代码
当我们操作dom的时候，发现数据读取的是上次的，就需要使用nextTick</p>
<p>具体实现</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import { nextTick, reactive, ref } from &#39;vue&#39;

const list = reactive([
  {name: &#39;zhangsan&#39;, message: &#39;xxxxxxx&#39;}
])

const box = ref&lt;HTMLDivElement&gt;()

const ipt = ref&lt;string&gt;(&#39;123&#39;)

// vue更新dom是异步的 数据更新是同步的
// 我们本次更新代码是同步代码
// 当我们操作dom的时候，发现数据读取的是上次的，就需要使用nextTick
const send = async () =&gt; {
  list.push({
    name: &#39;jdy2002&#39;,
    message: ipt.value
  })
  // 1.回调函数的模式
  // nextTick(() =&gt; {})
  // 2.async await
  await nextTick()
  box.value!.scrollTop = 99999
  // ipt.value = &#39;&#39;
}
&lt;/script&gt;

&lt;template&gt;
  &lt;div class=&quot;m-auto w-3/5&quot;&gt;
    &lt;h3 class=&quot;h-16 text-3xl flex items-center bg-amber-400&quot;&gt;张三: xxxxxxxx&lt;/h3&gt;
    &lt;ul ref=&quot;box&quot; class=&quot;border border-gray-400 my-2 p-1.5 h-60 overflow-y-scroll&quot;&gt;
      &lt;li v-for=&quot;(item, index) in list&quot; :key=&quot;index&quot;&gt;{{item.name}}: {{ item.message }}&lt;/li&gt;
    &lt;/ul&gt;
    &lt;textarea class=&quot;w-full border border-gray-400&quot; v-model=&quot;ipt&quot;&gt;&lt;/textarea&gt;
    &lt;div class=&quot;w-full flex justify-end&quot;&gt;
      &lt;button @click=&quot;send&quot; type=&quot;button&quot; class=&quot;flex justify-end&quot;&gt;send&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 id="-ionic">移动端Ionic</h3>
<p>配置<code>jdk</code>和<code>android sdk</code>环境变量</p>
<p>全局安装 <code>iconic</code></p>
<pre><code class="lang-bash">npm install -g @ionic/cli
</code></pre>
<p>创建项目</p>
<pre><code class="lang-bash">ionic start xxx tabs --type vue
</code></pre>
<p>运行项目</p>
<pre><code class="lang-bash">npm run dev
</code></pre>
<p>构建项目</p>
<pre><code class="lang-bash">npm run build
</code></pre>
<p>部署到安卓</p>
<pre><code class="lang-bash">ionic capacitor copy android
</code></pre>
<p>用Android studio打开android文件夹</p>
<h3 id="h5-">H5适配</h3>
<p>把所有px单位转换为vw单位</p>
<pre><code class="lang-ts">// postcss的插件
import { Plugin } from &#39;postcss&#39;

const Options= {
  viewportWidth: 375 // 默认视口宽度
}

interface Options {
  viewportWidth?: number
}

export const PostcssPxToViewport = (options: Options = Options): Plugin =&gt; {
  // 防止用户传入空对象
  const opt = Object.assign({}, Options, options)
  return {
    postcssPlugin: &#39;postcss-px-to-viewport&#39;,
    // 钩子函数
    Declaration(node: any) {
      if (node.value.includes(&#39;px&#39;)) {
        const num = parseFloat(node.value)
        // 将px转换为vw
        node.value = `${((num / opt.viewportWidth) * 100).toFixed(2)}vw`
      }
    }
  }
}
</code></pre>
<p>vite.config.ts</p>
<p>引入css插件</p>
<pre><code class="lang-ts">export default defineConfig({
  plugins: [
    vue()
  ],
  css: {
    postcss: {
      plugins: [PostcssPxToViewport()]
    }
  }
  ...
})
</code></pre>
<p>tsconfig.node.json</p>
<p>解决报错问题</p>
<pre><code class="lang-json">&quot;include&quot;: &quot;ts插件位置&quot;
</code></pre>
<p>全局样式设置</p>
<pre><code class="lang-css">&lt;style&gt;
:root {
    --size: &#39;14px&#39;;
}

xxx {
  font-size: var(--size);
}
&lt;style&gt;
</code></pre>
<p>使用VueUse</p>
<pre><code class="lang-ts">import { useCssVar } from &quot;@vueuse/core&quot;;

const change = (num: number) =&gt; {
  const size = useCssVar(&#39;--size&#39;)
  size.value = num + &#39;px&#39;
}
</code></pre>
<h3 id="unocss-">unoCss原子化</h3>
<pre><code class="lang-bash">npm install unocss
</code></pre>
<p>main.ts</p>
<pre><code class="lang-ts">import &#39;uno.css&#39;
</code></pre>
<p>vite.config.ts</p>
<pre><code class="lang-ts">export default defineConfig({
  plugins: [
    vue(),
    unoCss({
      rules: [
        [
          &#39;flex&#39;,
          {
            display: &#39;flex&#39;
          }
        ],
        [
          &#39;red&#39;,
          {
            color: &#39;red&#39;
          }
        ],
        [
          /^m-(\d+)$/,
          ([, d]) =&gt; ({
            margin: `${Number(d) * 10}px`
          })
        ]
      ],
      // 快捷方式
      shortcuts: {
        fr: [&#39;flex&#39;, &#39;red&#39;]
      }
    })
  ]
})
</code></pre>
<p>具体使用</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div class=&quot;flex red m-10&quot;&gt;
    div
  &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<p>预设</p>
<pre><code class="lang-ts">import {presetIcons, presetAttributify, presetUno} from &#39;unocss&#39;

export default defineConfig({
  plugins: [
    vue(),
    unoCss({
      presets: [presetIcons(), presetAttributify(), presetUno()],
    })
 ]
</code></pre>
<p>安装图标库</p>
<pre><code class="lang-bash">npm install -D @iconify-json/ic # ic为图标库名称 google material design
</code></pre>
<p>具体使用</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;!-- presetAttributify --&gt;
  &lt;div class=&quot;fr&quot; m=&quot;10&quot; flex red&gt;
    div
  &lt;/div&gt;
  &lt;!-- presetIcons --&gt;
  &lt;div class=&quot;i-ic-baseline-access-alarms&quot;&gt;&lt;/div&gt;
  &lt;!-- presetUno --&gt;
  &lt;div class=&quot;tailwind类名&quot;&gt;&lt;/div&gt;
&lt;/template&gt;
</code></pre>
<h3 id="electron-">electron桌面程序</h3>
<p>安装</p>
<pre><code class="lang-bash">npm install electron electron-builder -D
</code></pre>
<h3 id="-">编译宏</h3>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div&gt;child&lt;/div&gt;
  &lt;ul&gt;
    &lt;li v-for=&quot;(item, index) in data&quot; :key=&quot;index&quot;&gt;
      &lt;slot :item=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;!-- &lt;button @click=&quot;sned&quot;&gt;派发&lt;/button&gt; --&gt;
&lt;/template&gt;

&lt;script setup lang=&quot;ts&quot; generic=&quot;T&quot;&gt;
// defineSlots只有声明没有参数，没有任何参数，只能接收ts的类型
defineSlots&lt;{
  default(props: {item: T, index: number}): void
}&gt;()

defineProps&lt;{
  data: T[]
}&gt;()
/* const props = defineProps({
  name: {
    type: Array as PropType&lt;string[]&gt;,
    required: true,
  },
}) */
/* const props = defineProps&lt;{
  name: string[]
}&gt;()
console.log(props) */

// vue3.3对defineProps的改进，新增了对泛型支持
/*defineProps&lt;{
  name: T[]
}&gt;()*/

// const emit = defineEmits([&#39;change&#39;])
/* const emit = defineEmits&lt;{
  (e: &quot;change&quot;, value: string): void
}&gt;() */
// vue3.3改进
/* const emit = defineEmits&lt;{
  &#39;change&#39;: [name: string]
}&gt;()

const send = () =&gt; {
  emit(&quot;change&quot;, &quot;hello&quot;)
} */
// vue3.3内置了defineOptions 不需要下载插件
// 他里面属性跟optionsAPI一模一样的
defineOptions({
  name: &#39;dongyu&#39;,

})
&lt;/script&gt;

&lt;style scoped&gt;&lt;/style&gt;
</code></pre>
<h3 id="-">环境变量</h3>
<p>.env.development 创建开发环境变量 </p>
<pre><code class="lang-tex">VITE_HTTP = http://www.baidu.com
</code></pre>
<p>.env.production 创建生产环境变量 </p>
<pre><code class="lang-tex">VITE_HTTP = http://www.jd.com
</code></pre>
<p>组件中读取</p>
<pre><code class="lang-ts">console.log(import.meta.env)
</code></pre>
<p>在配置文件中获取</p>
<p>vite.config.ts</p>
<pre><code class="lang-ts">import { defineConfig, loadEnv } from &#39;vite&#39;

export default ({mode}: any) =&gt; {
  console.log(loadEnv(mode, process.cwd()))
  return defineConfig({...})
}
</code></pre>
<h3 id="webpack-vue">Webpack构建Vue</h3>
<p>1.创建一个空项目</p>
<p>2.创建目录public, src</p>
<p>3.执行命令</p>
<pre><code class="lang-bash">npm init -y # 初始化包管理器
tsc --init # 初始化typescript
</code></pre>
<p>4.在src创建assets，views，App.vue，main.ts</p>
<p>5.在public创建index.html</p>
<pre><code class="lang-html">&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot;
        content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;
  &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt;
  &lt;title&gt;webpack demo&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>6.新建webpack.config.js配置文件</p>
<p>7.安装webpack、webpack-cli、webpack-dev-server、html-webpack-plugin</p>
<pre><code class="lang-bash">npm install webpack webpack-cli webpack-dev-server html-webpack-plugin
</code></pre>
<p>8.配置webpack.config.js</p>
<pre><code class="lang-js">const { Configuration } = require(&#39;webpack&#39;)
const path = require(&quot;path&quot;);
const HtmlWebpackPlugin = require(&quot;html-webpack-plugin&quot;);

/**
 *
 * @type {Configuration} 支持类型提示
 */
const config = {
  mode: &quot;development&quot;, // 开发模式
  entry: &#39;./src/main.ts&#39;, // 入口文件位置
  output: { // 配置输出文件
    filename: &quot;[hash].js&quot;, // 打包后的文件名
    path: path.resolve(__dirname, &#39;dist&#39;) // 打包后的文件生成路径
  },
  resolve: {
    // 别名
    alias: {
      // @表示src的路径
      &#39;@&#39;: path.resolve(__dirname, &#39;src&#39;)
    },
    // 导入时自动补全后缀
    extensions: [&#39;.vue&#39;, &#39;.ts&#39;, &#39;.js&#39;]
  },
  plugins: [ // 打包插件 生成template模板
    new HtmlWebpackPlugin({
      template: &quot;./public/index.html&quot; // 模板位置
    })
  ]
}

module.exports = config;
</code></pre>
<p>9.添加命令</p>
<p>package.json</p>
<pre><code class="lang-json">&quot;scripts&quot;: {
    &quot;dev&quot;: &quot;webpack-dev-server&quot;,
    &quot;build&quot;: &quot;webpack&quot;
  },
</code></pre>
<p>10.安装vue</p>
<pre><code class="lang-bash">npm install vue
</code></pre>
<p>11.解决引入vue组件报错问题</p>
<p>src新建<code>env.d.ts</code></p>
<pre><code class="lang-ts">declare module &#39;*.vue&#39; {
  import { DefineComponent } from &#39;vue&#39;
  const component: DefineComponent&lt;{}, {}, any&gt;
  export default component
}
</code></pre>
<p>12.配置入口文件<strong>main.ts</strong></p>
<pre><code class="lang-ts">import {createApp} from &quot;vue&quot;;
import App from &quot;./App.vue&quot;;

createApp(App).mount(&#39;#app&#39;)
</code></pre>
<p>13.配置loader加载器</p>
<p>安装</p>
<pre><code class="lang-bash">npm install vue-loader@next @vue/compiler-sfc
</code></pre>
<p>webpack.config.js</p>
<pre><code class="lang-js">module: {
  // loader配置
  rules: [
    {
      test: /\.vue$/,
      use: &#39;vue-loader&#39;
    }
  ]
},
plugins: [
  ...
  new VueLoaderPlugin()
]
</code></pre>
<p>支持加载css、less</p>
<pre><code class="lang-bash">npm install css-loader style-loader less less-loader
</code></pre>
<pre><code class="lang-js">rules: [
    {
        // 支持加载 css文件
        test: /\.css$/,
        use: [&#39;style-loader&#39;, &#39;css-loader&#39;]
    },
    {
        test: /\.less$/,
        use: [&#39;style-loader&#39;, &#39;css-loader&#39;, &#39;less-loader&#39;]
    }
]
</code></pre>
<p>14.引入css|less文件</p>
<pre><code class="lang-vue">&lt;template&gt;
  &lt;div&gt;
    App123
  &lt;/div&gt;
&lt;/template&gt;

&lt;script setup&gt;
import &#39;@/assets/index.css&#39; // css
// import &#39;@/assets/index.less&#39; less
&lt;/script&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</code></pre>
<p>15.typescript支持</p>
<pre><code class="lang-bash">npm install typescript ts-loader
</code></pre>
<pre><code class="lang-js">rules: [
    {
        test: /\.ts$/,
        loader: &quot;ts-loader&quot;,
        options: {
          configFile: path.resolve(process.cwd(), &quot;tsconfig.json&quot;),
          appendTsSuffixTo: [/\.vue$/]
        }
    }
]
</code></pre>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import &#39;@/assets/index.less&#39;
import {ref} from &quot;vue&quot;;

const name = ref&lt;string&gt;(&#39;冬雨&#39;)
&lt;/script&gt;
</code></pre>
<p>16.优化打包日志</p>
<pre><code class="lang-bash">npm install friendly-errors-webpack-plugin
</code></pre>
<p>webpack.config.js</p>
<pre><code class="lang-js">stats: &quot;errors-only&quot;,
plugins: [
   new FriendlyErrorsWebpackPlugin({
        compilationSuccessInfo: { // 编译成功后打印的内容
               messages: [&#39;You application is running here: http://localhost:8080&#39;]
        }
    }) 
],
externals: {
   vue: &#39;Vue&#39; // 不将vue打包进js，使用在线地址引入
}
</code></pre>
<h3 id="-">性能优化</h3>
<p>安装分析插件</p>
<pre><code class="lang-bash">npm install rollup-plugin-visualizer
</code></pre>
<p>使用</p>
<pre><code class="lang-ts">plugins: [visualizer({open: true})]
</code></pre>
<p>打包配置优化</p>
<pre><code class="lang-ts">build: {
    // 打包警告大小
    chunkSizeWarningLimit: 2000,
    // css文件拆分
    cssCodeSplit: true,
    // 关闭sourcemap
    sourcemap: false,
    // esbuild打包速度快，terser打包体积小
    minify: &#39;terser&#39;,
    // 图片转base64限制大小
    assetsInlineLimit: 4000
}
</code></pre>
<p>pwa</p>
<pre><code class="lang-bash">npm install vite-plugin-pwa
</code></pre>
<pre><code class="lang-ts">plugins: [
    VitePWA({
      workbox:{
        cacheId:&quot;XIaoman&quot;,//缓存名称
        runtimeCaching:[
          {
            urlPattern:/.*\.js.*/, //缓存文件
            handler:&quot;StaleWhileRevalidate&quot;, //重新验证时失效
            options:{
              cacheName:&quot;XiaoMan-js&quot;, //缓存js，名称
              expiration:{
                maxEntries:30, //缓存文件数量 LRU算法
                maxAgeSeconds:30 * 24 * 60 * 60 //缓存有效期
              }
            }
          }
        ]
      },
    })
]
</code></pre>
<p>图片懒加载</p>
<pre><code class="lang-bash">npm install vue3-lazy
</code></pre>
<pre><code class="lang-ts">plugins: [
    lazyPlugin()
]
</code></pre>
<pre><code class="lang-vue">&lt;img v-lazy=&quot;user avatar&quot;&gt;
</code></pre>
<h3 id="web-components">web Components</h3>
<p>Web Components 提供了基于原生支持的、对视图层的封装能力，可以让单个组件相关的 javaScript、css、html模板运行在以html标签为界限的局部环境中，不会影响到全局，组件间也不会相互影响 。 再简单来说：就是提供了我们自定义标签的能力，并且提供了标签内完整的生命周期 。</p>
<p>用法</p>
<pre><code class="lang-js">class Btn extends HTMLElement {
  constructor() {
    super();

    const shaDow = this.attachShadow({mode: &quot;open&quot;})

    /*this.p = this.h(&#39;p&#39;)
    this.p.innerText = &#39;dongyu&#39;
    this.p.setAttribute(&#39;style&#39;, &#39;width: 200px; height: 200px; border: 1px solid red;&#39;)*/

    this.template = this.h(&#39;template&#39;)
    this.template.innerHTML = `
      &lt;style&gt;
        div {
          width: 200px;
          height: 200px;
          border: 1px solid red;
        }
      &lt;/style&gt;
      &lt;div&gt;dongyu&lt;/div&gt;
    `
    // shaDow.appendChild(this.p)
    shaDow.appendChild(this.template.content.cloneNode(true))
  }

  /**
   * 生命周期
   */
  //当自定义元素第一次被连接到文档 DOM 时被调用。
  connectedCallback() {
    console.log(&#39;我已经插入了！！！嗷呜&#39;)
  }

  //当自定义元素与文档 DOM 断开连接时被调用。
  disconnectedCallback() {
    console.log(&#39;我已经断开了！！！嗷呜&#39;)
  }

  //当自定义元素被移动到新文档时被调用
  adoptedCallback() {
    console.log(&#39;我被移动了！！！嗷呜&#39;)
  }
  //当自定义元素的一个属性被增加、移除或更改时被调用
  attributeChangedCallback() {
    console.log(&#39;我被改变了！！！嗷呜&#39;)
  }

  h(el) {
    return document.createElement(el)
  }
}

window.customElements.define(&#39;dongyu-btn&#39;, Btn);
</code></pre>
<p>网页中引入</p>
<pre><code class="lang-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script src=&quot;./btn.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;dongyu-btn&gt;&lt;/dongyu-btn&gt;
    &lt;dongyu-btn&gt;&lt;/dongyu-btn&gt;
    &lt;dongyu-btn&gt;&lt;/dongyu-btn&gt;
    &lt;dongyu-btn&gt;&lt;/dongyu-btn&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>在vue中使用</p>
<pre><code class="lang-ts">plugins: [
    vue({
      template: {
        compilerOptions: {
          isCustomElement: (tag) =&gt; tag.startsWith(&#39;dongyu-&#39;)
        }
      }
    })
]
</code></pre>
<p>新建组件custom-vue.ce.vue（必须.ce.vue结尾）</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
defineProps&lt;{
  obj: any
}&gt;()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;dongyu&lt;/div&gt;
  &lt;div&gt;{{JSON.parse(obj)}}&lt;/div&gt;
&lt;/template&gt;

&lt;style scoped&gt;

&lt;/style&gt;
</code></pre>
<p>在App.vue中使用</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;
import CustomVue from &#39;./components/custom-vue.ce.vue&#39;
import {defineCustomElement} from &quot;vue&quot;;

const Btn = defineCustomElement(CustomVue)

window.customElements.define(&#39;dongyu-btn&#39;, Btn)

const obj = {name: &#39;dongyu&#39;}
&lt;/script&gt;

&lt;template&gt;
  &lt;dongyu-btn :obj=&quot;JSON.stringify(obj)&quot;&gt;&lt;/dongyu-btn&gt;
&lt;/template&gt;
</code></pre>
<h3 id="proxy-">Proxy(代理)</h3>
<p>解决请求跨域的问题</p>
<p>vite.config.ts</p>
<pre><code class="lang-ts">server: {
    // 只适合本地开发，生产环境无效
    proxy: {
      // 将代理 /api这个请求地址
      &#39;/api&#39;: {
        target: &quot;http://localhost:9999&quot;, // 目标服务器请求地址
        changeOrigin: true, // 是否有跨域
        // 实际请求地址没有/api这个路径，所以将/api替换为空
        rewrite: (path) =&gt; path.replace(/^\/api/, &#39;&#39;),
      }
    }
  }
</code></pre>
<h3 id="-">可视化</h3>
<p>Api接口</p>
<p>1.安装环境</p>
<pre><code class="lang-bash">npm install ts-node -g # node中使用ts需要(第一次使用全局安装)
npm init -y # 初始化包管理工具
npm install @types/node -D # 添加node类型支持
npm install express -S # 安装express
npm install @types/express -D # 安装express 类型支持
npm install axios -S # 安装axios请求工具
</code></pre>
<p>代码地址 <a href="https://github.com/Yu2002s/COVID-19">github</a></p>
<h3 id="router-">Router(路由)</h3>
<p>安装依赖</p>
<pre><code class="lang-bash">npm install vue-router
</code></pre>
<p>使用示例</p>
<p>/router/index.js</p>
<pre><code class="lang-ts">import { createRouter, createWebHistory } from &#39;vue-router&#39;
import Home from &#39;@/views/Home.vue&#39;
import About from &#39;@/views/About.vue&#39;
import User from &#39;@/views/User.vue&#39;
import NotFound from &#39;@/components/NotFound.vue&#39;
import UserProfile from &#39;@/views/UserProfile.vue&#39;
import UserPosts from &#39;@/views/UserPosts.vue&#39;
import UserHome from &#39;@/views/UserHome.vue&#39;
import Register from &#39;@/views/Register.vue&#39;
import LeftSlide from &#39;@/views/LeftSlide.vue&#39;
import RightSlide from &#39;@/views/RightSlide.vue&#39;

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    {
      path: &#39;/&#39;,
      name: &#39;home&#39;,
      components: {
        default: Home,
        LeftSlide,
        RightSlide
      },
      // 独享守卫
      // 只有在进入时触发，不会在params、query、 hash改变是触发
      //只有在从一个不同的路由导航时才会被触发
      beforeEnter: (to, from) =&gt; {
        // console.log(&#39;enter&#39;)
        // return false
      }
    },
    {
      path: &#39;/about/:id&#39;,
      name: &#39;about&#39;,
      // route level code-splitting
      // this generates a separate chunk (About.[hash].js) for this route
      // which is lazy-loaded when the route is visited.
      component: About,
      // 定义元数据
      meta: {
        // 只有身份验证成功后才能进入
        requiresAuth: true
      }
    },
    {
      name: &#39;user-parent&#39;,
      path: &#39;/users/:id&#39;,
      component: User,
      sensitive: false,
      children: [
        {
          path: &#39;&#39;,
          name: &#39;user-home&#39;,
          component: UserHome
        },
        {
          name: &#39;user-profile&#39;,
          path: &#39;profile&#39;,
          component: UserProfile
        },
        {
          name: &#39;user-posts&#39;,
          path: &#39;posts&#39;,
          component: UserPosts
        }
      ]
    },
    {
      name: &#39;NotFound&#39;,
      // 匹配所有的地址，如果前面规则为匹配，则展示notfound
      path: &#39;/:pathMatch(.*)*&#39;,
      component: NotFound
    },
    {
      path: &#39;/user-:afterUser(.*)&#39;,
      component: User
    },
    {
      // :orderId 仅匹配数字
      // path: &#39;/:orderId(\\d+)&#39;,
      // 匹配 /one, /one/two, /one/two/three
      // path: &#39;/:chapters+&#39;,
      // 匹配 /, /one, /one/two
      name: &#39;chapters&#39;,
      path: &#39;/:chapters*&#39;,
      // 匹配 /1, /1/2
      // path: &#39;/:chapters(\\d+)+&#39;,
      // 匹配 /, /1, /1/2
      // path: &#39;/:chapters(\\d+)*&#39;,
      // 匹配 /users/, /users/jdy
      // path: &#39;/users/:userId?&#39;,
      // 匹配 /users, /users/12
      // path: &#39;/users/:userId(\\d+)?&#39;,
      component: NotFound
    },
    {
      name: &#39;register&#39;,
      path: &#39;/register&#39;,
      component: Register
    },
    {
      name: &#39;search&#39;,
      path: &#39;/search/:searchText&#39;,
      redirect: (to) =&gt; {
        return {
          path: &#39;/users&#39;,
          name: &#39;user-home&#39;,
          params: {
            id: to.params.searchText
          }
        }
      }
    },
    {
      // /users/jdy/posts 重定向到 /users/jdy/profile
      path: &#39;/users/:id/posts&#39;,
      redirect: (to) =&gt; {
        return &#39;profile&#39;
      }
      // 设置别名, 访问 /jdy 将展示
      // alias: [&#39;/jdy&#39;, &#39;jdy2&#39;]
    }
  ],
  // 全局规则
  strict: true, // 末尾不能出现/
  sensitive: true, // 区分大小写
  scrollBehavior(to, from, savedPosition) {
    if (to.hash) {
      return {
        el: &#39;#root&#39;,
        top: -100,
       // hash: to.hash
      }
    }
    return savedPosition
  }
})

router.onError(() =&gt; {
  console.log(&#39;error&#39;)
})

/*router.beforeEach(async (to, from, next) =&gt; {
  console.log(&#39;beforeEach: &#39;, to.path)
  // 访问到定义的元数据，判断是否需要进行身份验证
  console.log(to.meta.requiresAuth)
  if (i &gt;= 3) {
    i = 0
    // console.log(&#39;about&#39;)
    // 进行重定向跳转到指定页面
    // return {name: &#39;about&#39;, params: {id: &#39;jdy&#39;}}
    // 也可以使用next方法进行跳转
    // return &#39;/about/jdy&#39;
    next(&#39;/about/jdy&#39;)
  } else {
    i++
    next()
  }
  // return 可以取消导航
  // return false
})*/

/*router.beforeResolve((to) =&gt; {
  if (i &gt;= 3) {
    i = 0
    return false
  } else {
    i++
  }

  console.log(&#39;beforeResolve: &#39;, to.path)
})*/

/*router.afterEach((to, from, failure) =&gt; {
  console.log(&#39;afterEach: &#39;, to.fullPath)
})*/

export default router
</code></pre>
<p>main.ts</p>
<pre><code class="lang-tsx">import router from &#39;./router/index.js&#39;

app.use(router)
</code></pre>
<p>App.vue</p>
<pre><code class="lang-vue">&lt;script setup lang=&quot;ts&quot;&gt;&lt;/script&gt;

&lt;template&gt;
  &lt;div id=&quot;app-container&quot;&gt;
    &lt;RouterLink to=&quot;/&quot;&gt;Home&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/about/id&quot;&gt;About&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/users/john&quot;&gt;John&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/users/dongyu&quot;&gt;Dongyu&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/users/john/profile&quot;&gt;Profile&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/users/dongyu/posts&quot;&gt;Posts&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/a&quot;&gt;测试&lt;/RouterLink&gt;
    &lt;RouterLink to=&quot;/user-a&quot;&gt;前缀匹配&lt;/RouterLink&gt;
    &lt;div id=&quot;main&quot;&gt;
      &lt;RouterView name=&quot;LeftSlide&quot; /&gt;
      &lt;RouterView v-slot=&quot;{ Component, route }&quot;&gt;
        &lt;Transition name=&quot;fade&quot;&gt;
          &lt;component :is=&quot;Component&quot; :key=&quot;route.path&quot; /&gt;
        &lt;/Transition&gt;
      &lt;/RouterView&gt;
      &lt;RouterView name=&quot;RightSlide&quot; /&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;

&lt;style scoped lang=&quot;less&quot;&gt;
#app-container {
  height: 100%;
}

a {
  color: black;
  text-decoration: none;
  padding: 6px;

  &amp;:hover {
    color: skyblue;
  }
}

#main {
  display: flex;
  height: 100%;

  &amp; &gt; div {
    flex: 1;
    height: 100%;
  }
}

.fade-enter-from,
.fade-leave-to {
  opacity: 0;
  transform: translateX(100px);
}

.fade-enter-active,
.fade-leave-active {
  transform: translateX(100px);
  transition: all 0.8s ease;
}
&lt;/style&gt;
</code></pre>
<h3 id="pm2-node-">pm2(node进程管理)</h3>
<p>全局安装依赖</p>
<pre><code class="lang-bash">npm install pm2 -g
</code></pre>
<p>使用方法</p>
<pre><code class="lang-bash">pm2 start index.js [--watch] -n 指定名称 # 启动进程
pm2 log # 查看日志
pm2 list #查看进程列表
pm2 stop 0 # 根据id停止进程
pm2 restart 0 # 重启进程
pm2 delete 0 # 删除进程
pm2 monit # 进入管理页面
</code></pre>

          	</article>
        </div>
		</div>
  </body>
</html>
<script type="text/javascript" src="toc/js/jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="toc/js/jquery.ztree.all-3.5.min.js"></script>
<script type="text/javascript" src="toc/js/ztree_toc.js"></script>
<script type="text/javascript" src="toc_conf.js"></script>

<SCRIPT type="text/javascript" >
<!--
$(document).ready(function(){
    var css_conf = eval(markdown_panel_style);
    $('#readme').css(css_conf)
    
    var conf = eval(jquery_ztree_toc_opts);
		$('#tree').ztree_toc(conf);
});
//-->
</SCRIPT>